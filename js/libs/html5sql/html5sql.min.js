/* html5sql.js MIT v0.9.3 http://html5sql.com/ */
var html5sql=function(){var a=false,b=function(){},c=[],d=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},e=function(a){return Object.prototype.toString.call(a)==="[object Array]"},f=function(a){return a===void 0},g=new RegExp("^select\\s","i"),h=function(a){return g.test(a)},b=function(){},i=function(a,b,c,d){var e=0,f=null,g=null,i=function(){a.executeSql(b[e].sql,b[e].data,j,k)},j=function(a,d){var g,j,k=[];if(html5sql.logInfo){console.log("Success processing: "+b[e].sql)}if(html5sql.putSelectResultsInArray&&h(b[e].sql)){for(g=0,j=d.rows.length;g<j;g++){k[g]=d.rows.item(g)}}else{k=null}f=b[e].success(a,d,k);e++;if(f&&$.isArray(f)){b[e].data=f;f=null}else{f=null}if(b.length>e){i()}else{c(a,d,k)}},k=function(a,c){if(html5sql.logErrors){console.error("Error: "+c.message+" while processing statment "+(e+1)+": "+b[e].sql)}d(c,b[e].sql)};i()},j=function(a){var c;if(typeof a==="string"){d(a);a=a.split(";");for(c=1;c<a.length;c++){while(a[c].split(/["]/gm).length%2===0||a[c].split(/[']/gm).length%2===0||a[c].split(/[`]/gm).length%2===0){a.splice(c,2,a[c]+";"+a[c+1])}a[c]=d(a[c])+";";if(a[c]===";"){a.splice(c,1)}}}if(e(a)===false){a=[a]}for(c=0;c<a.length;c++){if(typeof a[c]==="string"){a[c]={sql:a[c],data:[],success:b}}else{if(f(a[c].data)){a[c].data=[]}if(f(a[c].success)){a[c].success=b}if(typeof a[c]!=="object"||typeof a[c].sql!=="string"||typeof a[c].success!=="function"||!$.isArray(a[c].data)){throw new Error("Malformed sql object: "+a[c])}}}return a},k=function(a){var b=0;do{if(!h(a[b].sql)){return false}b++}while(b<a.length);return true};return{database:null,logInfo:false,logErrors:false,defaultFailureCallback:b,putSelectResultsInArray:true,openDatabase:function(b,c,d,e){html5sql.database=openDatabase(b,"",c,d);a=typeof html5sql.database.readTransaction==="function";if(e){e()}},process:function(c,d,e){if(html5sql.database){var g=j(c);if(f(d)){d=b}if(f(e)){e=html5sql.defaultFailureCallback}if(k(g)&&a){html5sql.database.readTransaction(function(a){i(a,g,d,e)})}else{html5sql.database.transaction(function(a){i(a,g,d,e)})}}else{if(html5sql.logErrors){console.error("Error: Database needs to be opened before sql can be processed.")}return false}},changeVersion:function(a,c,d,e,g){if(html5sql.database){if(html5sql.database.version===a){var h=j(d);if(f(e)){e=b}if(f(g)){g=html5sql.defaultFailureCallback}html5sql.database.changeVersion(a,c,function(a){i(a,h,e,g)})}}else{if(html5sql.logErrors){console.log("Error: Database needs to be opened before sql can be processed.")}return false}}}}()